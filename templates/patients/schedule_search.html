{% extends "base.html" %}

{% block title %}查詢門診班表{% endblock %}

{% block content %}
<h1>查詢門診班表</h1>
<form method="get" class="grid">
  <label>
    {{ form.date.label_tag }}
    {{ form.date }}
  </label>
  <label>
    {{ form.department.label_tag }}
    {{ form.department }}
  </label>
  <button type="submit">查詢</button>
</form>

<table>
  <thead>
    <tr>
      <th>日期</th>
      <th>時段</th>
      <th>科別</th>
      <th>醫師</th>
      <th>剩餘名額</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for schedule in schedules %}
      <tr>
        <td>{{ schedule.date }}</td>
        <td>{{ schedule.get_session_display }}</td>
        <td>{{ schedule.doctor.department.name }}</td>
        <td><a href="{% url 'patients:doctor-detail' schedule.doctor.pk %}">{{ schedule.doctor.user.display_name }}</a></td>
        <td>{{ schedule.remaining_quota }}/{{ schedule.quota }}</td>
        <td>
          {% if schedule.remaining_quota > 0 and schedule.status == 'open' %}
            <a href="{% url 'patients:appointment-book' schedule.pk %}" role="button">預約</a>
          {% else %}
            <span>額滿</span>
          {% endif %}
        </td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="6">目前查詢沒有結果。</td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
