# 智慧醫院掛號系統開發進度

## 已完成項目
- 初始化 Django 專案（自訂 settings、環境變數載入、PostgreSQL/SQLite 切換、`CONN_MAX_AGE` 等部署建議）。
- 建立核心資料模型與 Django Admin（使用者角色、自訂病患/家屬、科別、醫師、班表、掛號、公告、系統作業）。
- 完成病患註冊、登入/登出流程，註冊時同步產生病歷號並建立 `Patient` 紀錄。對應需求 A1、A2、A13。
- 病患端已完成：
  - A3 病患查詢科別門診（門診班表查詢頁，可依日期/科別篩選並呈現剩餘名額）。
  - A4 病患查詢醫師資訊（醫師詳細頁）。
  - A5 病患預約掛號（預約表單、號碼產生、防重複與額滿驗證、事件紀錄）。
  - A6 病患查詢掛號紀錄（列表顯示醫師/科別/就診對象，提供進度/取消操作）。
  - A7 病患取消預約掛號（掛號紀錄頁提供取消操作）。
  - A8 病患查詢看診進度（顯示目前叫號、報到/等待統計、最近事件）。
  - A9 病患修改個人資料（姓名、聯絡方式、地址、生日、緊急聯絡人）。
  - A10 病患變更登入密碼（自訂頁面，使用 Django 密碼變更流程）。
  - A11 病患設定常用家屬（列表、建立、編輯、刪除）。
  - A12 病患代為家屬掛號（預約表單可選擇既有家屬）。
- 病患儀表板顯示即將到來的掛號並提供快捷導向。
- 前端模板整合（首頁導向註冊/儀表板、訊息顯示等）。

## 部分尚未完成
- 醫師/護理師端（C21–C24）：報到名單、叫號、暫停/結束門診操作。
- 管理員前端（D25–D30）：醫師資料與班表維護、科別管理、統計報表、公告發佈。
- 系統自動作業（E31–E34）：提醒通知、開放掛號、生產報表、資料備份。

## 建議下一步
1. 擴充醫師儀表板（叫號流程、門診狀態控制、事件記錄）。
2. 建立管理員專用前端以維護醫師、班表與科別資料，並補齊公告/統計功能。
3. 規劃系統自動作業流程與排程機制，完善通知、報表與備份。

## 詳細事件對照

| 編號 | 事件名稱 | 觸發器 | 來源 | 活動 | 回應 | 目的地 | 狀態 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| A1 | 病患註冊新帳號 | 註冊資料(身分證號、姓名、生日、手機) | 病患 | 建立一筆新的病患基本資料與帳號 | 註冊成功訊息、預設密碼 | 使用者 | ✅ 已完成 |
| A2 | 病患登入系統 | 帳號(身分證號)、密碼 | 病患 | 驗證使用者身份 | 登入成功/失敗訊息、身分令牌(token) | 使用者 | ✅ 已完成 |
| A3 | 病患查詢科別門診 | 查詢條件(日期、科別) | 病患 | 查詢符合條件的科別與醫師班表 | 門診時間表、可掛號人數 | 使用者 | ✅ 已完成 |
| A4 | 病患查詢醫師資訊 | 醫師姓名 | 病患 | 查詢特定醫師的學經歷與專長 | 醫師詳細資料 | 使用者 | ✅ 已完成 |
| A5 | 病患預約掛號 | 掛號請求(時段、醫師) | 病患 | 產生一筆新的掛號紀錄 | 掛號成功通知、看診號碼 | 使用者 | ✅ 已完成 |
| A6 | 病患查詢掛號紀錄 | 查詢請求 | 病患 | 查詢該病患所有歷史與未來的掛號紀錄 | 掛號紀錄列表 | 使用者 | ✅ 已完成 |
| A7 | 病患取消預約掛號 | 取消請求(指定某筆掛號) | 病患 | 更新該筆掛號紀錄的狀態為「已取消」 | 取消成功通知 | 使用者 | ✅ 已完成 |
| A8 | 病患查詢看診進度 | 查詢請求 | 病患 | 查詢特定門診目前的看診號碼 | 目前看診號碼、預計等待時間 | 使用者 | ✅ 已完成 |
| A9 | 病患修改個人資料 | 修改後的個人資料 | 病患 | 更新病患基本資料 | 修改成功訊息 | 使用者 | ✅ 已完成 |
| A10 | 病患變更登入密碼 | 舊密碼、新密碼 | 病患 | 更新使用者密碼 | 密碼變更成功通知 | 使用者 | ✅ 已完成 |
| A11 | 病患設定常用家屬 | 家屬基本資料 | 病患 | 新增一筆家屬資料並與主帳號關聯 | 新增成功訊息 | 使用者 | ✅ 已完成 |
| A12 | 病患代為家屬掛號 | 掛號請求、家屬資料 | 病患 | 以家屬身分產生一筆新的掛號紀錄 | 掛號成功通知、看診號碼 | 使用者 | ✅ 已完成 |
| A13 | 病患登出系統 | 登出請求 | 病患 | 銷毀使用者登入狀態 | 登出成功畫面 | 使用者 | ✅ 已完成 |
| B14 | 櫃檯人員現場掛號 | 病患證件、掛號請求 | 櫃檯人員 | 產生一筆新的掛號紀錄 | 掛號單據、看診號碼 | 病患、櫃檯人員 | ✅ 已完成 |
| B15 | 櫃檯人員建立新病歷 | 病患初診資料 | 櫃檯人員 | 建立一筆新的病患基本資料 | 新病歷號碼 | 病患、櫃檯人員 | ✅ 已完成 |
| B16 | 櫃檯人員查詢病患資料 | 身分證號/病歷號 | 櫃檯人員 | 查詢特定病患的詳細資料與掛號歷史 | 病患資料畫面 | 櫃檯人員 | ✅ 已完成 |
| B17 | 櫃檯人員修改病患資料 | 修改後的病患資料 | 櫃檯人員 | 更新病患基本資料 | 修改成功確認 | 櫃檯人員 | ✅ 已完成 |
| B18 | 櫃檯人員取消掛號 | 取消請求、病患身分 | 櫃檯人員 | 更新掛號紀錄狀態為『已取消』 | 取消確認單 | 病患、櫃檯人員 | ✅ 已完成 |
| B19 | 櫃檯人員辦理報到 | 病患證件 | 櫃檯人員 | 更新掛號紀錄狀態為『已報到』 | 報到成功訊息 | 診間系統、櫃檯人員 | ✅ 已完成 |
| B20 | 櫃檯人員查詢門診狀態 | 查詢條件(科別、醫師) | 櫃檯人員 | 查詢特定門診的掛號總人數與報到人數 | 門診狀態列表 | 櫃檯人員 | ✅ 已完成 |
| C21 | 醫師查詢門診列表 | 查詢請求 | 醫師 | 查詢今日已報到的病患列表 | 病患列表(依報到順序) | 醫師 | ⏳ 未實作 |
| C22 | 醫師呼叫下一位病患 | 叫號請求 | 醫師 | 更新看診進度、推播叫號資訊 | 下一位病患資料 | 醫師、診間看板、病患 App | ⏳ 未實作 |
| C23 | 醫師暫停/恢復看診 | 狀態變更請求 | 醫師 | 更新門診狀態為『暫停看診』或『恢復看診』 | 狀態變更成功確認 | 診間看板、櫃檯人員 | ⏳ 未實作 |
| C24 | 醫師宣告門診結束 | 結束請求 | 醫師 | 更新門診狀態為『看診結束』 | 門診結束確認 | 系統 | ⏳ 未實作 |
| D25 | 管理員新增醫師資料 | 醫師基本資料、帳號 | 系統管理員 | 建立一筆新的醫師資料與系統帳號 | 新增成功訊息 | 管理後台 | ⏳ 未實作 (Admin 後台可操作，缺專用前端) |
| D26 | 管理員設定醫師班表 | 班表資料(日期、時段、診間、限額) | 系統管理員 | 建立或更新醫師的門診班表 | 班表設定成功訊息 | 管理後台 | ⏳ 未實作 (Admin 後台可操作，缺專用前端) |
| D27 | 管理員新增科別資訊 | 科別名稱、介紹 | 系統管理員 | 建立一筆新的科別資料 | 新增成功訊息 | 管理後台 | ⏳ 未實作 (Admin 後台可操作，缺專用前端) |
| D28 | 管理員停用醫師帳號 | 停用請求 | 系統管理員 | 更新醫師帳號狀態為『停用』 | 停用成功確認 | 管理後台 | ⏳ 未實作 |
| D29 | 管理員查詢掛號統計 | 查詢條件(日期區間、科別) | 系統管理員 | 產生掛號數據統計報表 | 統計報表 | 管理後台、經理 | ⏳ 未實作 |
| D30 | 管理員發布系統公告 | 公告內容 | 系統管理員 | 新增一筆系統公告 | 發布成功訊息 | 所有使用者 | ⏳ 未實作 (Admin 後台可操作，缺專用前端) |
| E31 | 系統發送掛號提醒 | 時間(看診前一日) | 系統 | 批次發送預約提醒通知 | 手機簡訊/App 推播 | 已預約病患 | ⏳ 未實作 |
| E32 | 系統開放未來掛號 | 時間(指定日期凌晨0點) | 系統 | 更新特定日期範圍的班表為『可掛號』狀態 | 狀態更新紀錄 | 系統日誌 | ⏳ 未實作 |
| E33 | 系統產生每日報表 | 時間(每日結束營業時) | 系統 | 彙總當日各科別掛號、報到、取消的數據 | 每日營運報表 | 醫院管理層 | ⏳ 未實作 |
| E34 | 系統備份資料庫 | 時間(每日凌晨) | 系統 | 執行資料庫備份程序 | 備份成功/失敗日誌 | 系統管理員 | ⏳ 未實作 |
